!function(){"use strict";app=app||{},app.Products=Backbone.Model.extend({idAttribute:"_id",url:"/account/products/"}),app.NewProduct=Backbone.Model.extend({idAttribute:"_id",url:"/account/products/"}),app.Serial=Backbone.Model.extend({url:"/account/products/",defaults:{success:!1,errors:[],errfor:{},serial:""}}),app.Badges=Backbone.Model.extend({url:"/account/products/",defaults:{success:!1,errors:[],errfor:{},badges:""}}),app.SerialView=Backbone.View.extend({el:"#serial",template:_.template($("#tmpl-serial").html()),events:{"click .btn-send":"send"},initialize:function(){this.model=new app.Serial,this.listenTo(this.model,"sync",this.render),this.render()},render:function(){this.$el.html(this.template(this.model.attributes))},send:function(){this.model.save({serial:this.$el.find('[name="serial"]').val()})}}),app.BadgesView=Backbone.View.extend({el:"#badges",template:_.template($("#tmpl-badges").html()),data:$("#data-products"),initialize:function(){this.model=new app.Badges,this.model.set({badges:app.mainView.products.attributes}),this.listenTo(app.serialView.model,"change",this.syncUp),this.listenTo(this.model,"sync",this.render),this.render()},syncUp:function(){if(app.serialView.model.attributes.hasOwnProperty("newproduct")){var a=new app.Products;a.fetch({url:"/account/products/fetch/",success:function(a){alert("success"),this.model.set({badges:a}),alert("render 2: "+JSON.stringify(this.model.attributes)),this.render()},error:function(){}})}},render:function(){alert("render 1: "+JSON.stringify(this.model.attributes)),this.$el.html(this.template(this.model.attributes))}}),app.MainView=Backbone.View.extend({el:".page .container",initialize:function(){app.mainView=this,this.products=new app.Products(JSON.parse(unescape($("#data-products").html()))),app.serialView=new app.SerialView,app.badgesView=new app.BadgesView}}),$(document).ready(function(){app.mainView=new app.MainView})}();
//# sourceMappingURL=index.min.js.map